<script src="https://cdn.jsdelivr.net/npm/datalist-polyfill@1.22.1/datalist-polyfill.min.js"></script>

<datalist id="crafters-list-Chicago">
  <option value="Auto Assign"></option>
  <% @chicago_crafters.each do |crafter| %>
    <option value="<%= crafter.name %>"><%= crafter.name %></option>
  <% end %>
</datalist>

<datalist id="crafters-list-London">
  <option value="Auto Assign"></option>
  <% @london_crafters.each do |crafter| %>
    <option value="<%= crafter.name %>"><%= crafter.name %></option>
  <% end %>
</datalist>

<datalist id="crafters-list-Los Angeles">
  <option value="Auto Assign"></option>
  <% @la_crafters.each do |crafter| %>
    <option value="<%= crafter.name %>"><%= crafter.name %></option>
  <% end %>
</datalist>

<div class="container unassigned">
  <h1 class="center">Unassigned Applicants</h1>
  <% if @applicants.present? %>
    <div class="row">
      <div class="column middle">
        <% @applicants.each do |app| %>
        <div class="card">
            <%= link_to app.name, applicant_path(app.id), :class => "applicant-name column one-third" %>
            <div class="column one-third applicant-details">
              <p><%= app.location %></p>
              <p>Applied <%= pluralize(@applicant_presenter.days_since_last_applied(app.applied_on), "day", "days") %> ago</p>
            </div>
            <span class="applicant-actions">
              <%= form_for :applicant_to_assign, url: specify_craftsman_path, method: :post do |f| %>
                <div class="top_section">
                  <label class="dropdown-label">Assign to:</label>
                  <%= f.text_field :chosen_crafter, autocomplete: 'off', list: "crafters-list-#{app.location}", value: "Auto Assign" %>
                  <%= f.hidden_field(:id, :value => app.id) %>
                  <%= f.hidden_field(:source, :value => "unassigned") %>
                </div>
                <div class="bottom_section">
                  <%= f.submit "Submit", class: "button primary" %>
                  <%= link_to "Deny", {:controller => 'applicants', :action => 'deny_application', :id => app.id }, {:class => "button secondary", data: { confirm: "Are you sure you want to deny #{app.name}?" }} %>
                </div>
                <% end %>
            </span>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

